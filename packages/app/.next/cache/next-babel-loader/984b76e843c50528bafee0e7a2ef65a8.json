{"ast":null,"code":"/**\n * Returns users from Auth0 Management API with matching email\n * for the user in current session if his email is verified.\n *\n * Linking identities out of the box is in Developer plan in Auth0,\n * this code is reminder to consider upgrading.\n */\nimport { auth } from \"../../../src/app/auth\";\nexport default async function me(req, res) {\n  try {\n    const session = await auth.getSession(req);\n\n    if (!session) {\n      return res.status(401);\n    }\n\n    if (!session.user.email_verified) {\n      return res.status(403);\n    }\n\n    const users = await auth.management.getUsersByEmail(session.user.email);\n    const json = {\n      users\n    };\n    return res.json(json);\n  } catch (error) {\n    console.error(error);\n    return res.status(error.status || 500).end(error.message);\n  }\n}","map":null,"metadata":{},"sourceType":"module"}