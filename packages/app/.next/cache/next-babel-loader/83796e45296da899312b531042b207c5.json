{"ast":null,"code":"import { setCookie } from \"nookies\";\nimport { auth } from \"../../src/app/auth\";\nimport { noop } from \"../../src/lib/noop\";\nexport default async function login(req, res) {\n  try {\n    // we want to postpone the redirect\n    const {\n      end,\n      writeHead\n    } = res;\n    res.end = noop;\n    let writeArgs = [];\n\n    res.writeHead = (...args) => {\n      writeArgs = args;\n      return res;\n    };\n\n    await auth.handleLogin(req, res, {\n      authParams: {\n        scope: \"openid email profile\"\n      }\n    });\n    setCookie({\n      res\n    }, \"zm|redirectTo\", req.headers.referer || \"/\", {});\n    res.writeHead = writeHead;\n    res.end = end;\n    res.writeHead(...writeArgs).end();\n  } catch (error) {\n    res.status(error.status || 500).end(error.message);\n  }\n}","map":null,"metadata":{},"sourceType":"module"}