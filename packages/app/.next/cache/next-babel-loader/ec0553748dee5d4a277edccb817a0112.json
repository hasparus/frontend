{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\nimport { Heading } from \"theme-ui\";\nimport useSWR from \"swr\";\nimport fetch from \"isomorphic-unfetch\";\nimport { assert } from \"ts-essentials\";\nimport { Page } from \"../src/app/components\";\nimport { auth } from \"../src/app/auth\";\nimport { Dl } from \"../src/ui\";\nimport { MaxWidthContainer } from \"../src/app/components/MaxWidthContainer\";\nimport { useAppState } from \"../src/app/store\";\nimport { HttpError } from \"../src/lib/HttpError\";\nimport { jsx } from \"theme-ui\";\n\nvar Settings = function Settings() {\n  var _useAppState = useAppState(),\n      sessionUsere = _useAppState.user;\n\n  var sameEmailUsers = useSWR(\"/api/u/me\", function (url) {\n    return fetch(url).then(function (res) {\n      if (res.ok) {\n        // TODO: consider io-ts or typescript-is?\n        return res.json();\n      }\n\n      throw new HttpError(res);\n    });\n  });\n\n  if (sameEmailUsers.error) {\n    // TODO: handle 403: don't show anything\n    console.error(sameEmailUsers);\n  }\n\n  assert(sessionUsere, \"if user session is not present, we should have been redirected\");\n  return jsx(Page, null, jsx(MaxWidthContainer, {\n    sx: {\n      py: 4\n    }\n  }, jsx(\"p\", null, \"Disclaimer: We show too much data and this page will certainly change in the future. In the meanwhile, it's useful for debugging.\"), jsx(\"p\", null, \"We might leave this as a \\\"development view\\\" of settings.\"), jsx(\"section\", null, jsx(Heading, {\n    as: \"h3\"\n  }, \"Your Session Data\"), jsx(Dl.FromObject, {\n    value: sessionUsere\n  })), sameEmailUsers.data && jsx(\"section\", null, jsx(Heading, {\n    as: \"h3\"\n  }, \"Your Accounts\"), sameEmailUsers.data.users.map(function (user) {\n    return jsx(Dl.FromObject, {\n      value: user,\n      key: user.user_id\n    });\n  }))));\n};\n\nSettings.getInitialProps = function (_ref) {\n  var req = _ref.req,\n      res = _ref.res;\n  return auth.getSessionOrLogIn(req, res);\n};\n\nexport default Settings;","map":null,"metadata":{},"sourceType":"module"}